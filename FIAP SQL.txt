-- **************** DROP TABLES *****************
-- DROP TABLE T_PESSOA;
-- DROP TABLE T_META;
-- DROP TABLE T_TRANSACAO;
-- DROP TABLE T_INVESTIMENTO;
-- DROP TABLE T_GASTO;
-- DROP TABLE T_RECEITA;

-- *************** CREATE TABLES ****************

CREATE TABLE T_PESSOA
(
    CD_PESSOA       NUMBER(6)       NOT NULL,
    NM_PESSOA       VARCHAR2(50)    NOT NULL,
    NM_CPF          VARCHAR2(11)    NOT NULL,
    DT_NASCIMENTO   DATE            NOT NULL,
    DS_EMAIL        VARCHAR2(40)    NOT NULL
);

ALTER TABLE T_PESSOA
    ADD CONSTRAINT PK_PESSOA PRIMARY KEY (CD_PESSOA);

CREATE TABLE T_META
(
    CD_META             NUMBER(2)       NOT NULL,
    CD_PESSOA           NUMBER(6)       NOT NULL,
    NM_META             VARCHAR2(30)    NOT NULL,
    DT_META_CRIACAO     DATE            NOT NULL,
    DT_META_FINAL       DATE            NOT NULL,
    VL_META             NUMBER(11,2)    NOT NULL
);

ALTER TABLE T_META
    ADD CONSTRAINT PK_META PRIMARY KEY (CD_META);

ALTER TABLE T_META
    ADD CONSTRAINT FK_PESSOA_META FOREIGN KEY (CD_PESSOA)
        REFERENCES T_PESSOA (CD_PESSOA);

CREATE TABLE T_GASTO
(
    CD_GASTO            NUMBER(11)      NOT NULL,
    NM_GASTO            VARCHAR2(30)    NOT NULL,
    VL_GASTO            NUMBER(11,2)    NOT NULL,
    DS_TIPO             VARCHAR2(30)    NOT NULL
);

ALTER TABLE T_GASTO
    ADD CONSTRAINT PK_GASTO PRIMARY KEY (CD_GASTO);

CREATE TABLE T_RECEITA
(
    CD_RECEITA         NUMBER(11)      NOT NULL,
    NM_RECEITA         VARCHAR2(30)    NOT NULL,
    VL_RECEITA         NUMBER(11,2)    NOT NULL,
    DS_TIPO            VARCHAR2(30)    NOT NULL
);

ALTER TABLE T_RECEITA
    ADD CONSTRAINT PK_RECEITA PRIMARY KEY (CD_RECEITA);

CREATE TABLE T_INVESTIMENTO
(
    CD_INVESTIMENTO         NUMBER(11)      NOT NULL,
    NM_INVESTIMENTO         VARCHAR2(30)    NOT NULL,
    VL_INVESTIMENTO         NUMBER(11,2)    NOT NULL,
    DS_TIPO                 VARCHAR2(30)    NOT NULL,
    VL_RENDIMENTO           NUMBER(11,5)    NOT NULL,
    DT_DISPONIVEL           DATE            NOT NULL
);

ALTER TABLE T_INVESTIMENTO
    ADD CONSTRAINT PK_INVESTIMENTO PRIMARY KEY (CD_INVESTIMENTO);
        
CREATE TABLE T_TRANSACAO
(
    CD_TRANSACAO        NUMBER(11)      NOT NULL,
    VL_TRANSACAO        NUMBER(6,2)     NOT NULL,
    DT_TRANSACAO        DATE            NOT NULL,
    CD_GASTO            NUMBER(11)      NULL,
    CD_RECEITA          NUMBER(11)      NULL,
    CD_INVESTIMENTO     NUMBER(11)      NULL,
    CD_PESSOA           NUMBER(6)       NULL
);

ALTER TABLE T_TRANSACAO
    ADD CONSTRAINT PK_TRANSACAO PRIMARY KEY (CD_TRANSACAO);

ALTER TABLE T_TRANSACAO
    ADD CONSTRAINT FK_GASTO_TRANSACAO FOREIGN KEY (CD_GASTO)
        REFERENCES T_GASTO (CD_GASTO);

ALTER TABLE T_TRANSACAO
    ADD CONSTRAINT FK_RECEITA_TRANSACAO FOREIGN KEY (CD_RECEITA)
        REFERENCES T_RECEITA (CD_RECEITA);

ALTER TABLE T_TRANSACAO
    ADD CONSTRAINT FK_INVESTIMENTO_TRANSACAO FOREIGN KEY (CD_INVESTIMENTO)
        REFERENCES T_INVESTIMENTO (CD_INVESTIMENTO);

ALTER TABLE T_TRANSACAO
    ADD CONSTRAINT FK_PESSOA_TRANSACAO FOREIGN KEY (CD_PESSOA)
        REFERENCES T_PESSOA (CD_PESSOA);
    